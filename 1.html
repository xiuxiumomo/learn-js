<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
    </head>
    <style></style>
    <body>
        <div id="box">
            <ul>
                <li>
                    <a href="#/page1">page1</a>
                </li>
                <li>
                    <a href="#/page2">page2</a>
                </li>
                <li>
                    <a href="#/page3">page3</a>
                </li>
                <li>
                    <a href="#/page4">page4</a>
                </li>
            </ul>
            <div id="container"></div>
        </div>
        <script>
            class HashRouter {
                constructor() {
                    this.routers = {}
                    window.addEventListener('hashchange', this.load.bind(this), false)
                }

                //注册视图
                register(hashName, callBack = () => {}) {
                    this.routers[hashName] = callBack
                }
                //注册首页
                registerIndex(callBack = () => {}) {
                    this.routers['index'] = callBack;
                }
                //404
                registerNotFound(callBack = () => {}) {
                    this.routers['404'] = callBack
                }
                //异常
                registerError(callBack = () => {}) {
                    this.routers['error'] = callBack;
                }
                //load
                load() {
                    let hash = location
                            .hash
                            .slice(1),
                        handler = null;
                    if (hash) {
                        handler = this.routers[hash]
                    } else if(!this.routers.hasOwnProperty(hash)){
                        handler = this.$routers['404'] || function() {}
                    }else{
                        handler = this.routers['index']
                    }
                    try{
                        handler.call(this)
                    } catch(e) {
                        (this.routers['error'] || function() {}).call(this,e)
                    }
                   
                }
            }

            let router = new HashRouter();
            let container = document.getElementById('container');
            router.registerIndex(() => container.innerHTML = '首页')
            router.register('/page1', () => container.innerHTML = 'page1')
            router.register('/page2', () => container.innerHTML = 'page2')
            router.register('/page3', () => container.innerHTML = 'page3')
            router.register('/page4', () => container.innerHTML = 'page4')
            router.load()
            router.registerNotFound(() => container.innerHTML = '未发现页面')
            router.registerError((e) => container.innerHTML = `页面异常${e.message}`)
          
        </script>

    </body>
</html>