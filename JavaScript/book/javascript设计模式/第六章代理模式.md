## 代理模式

> 在四月一个晴朗的早晨，小明遇见了他的百分百女孩，我们暂且称呼小明的女神为
> A。两天之后，小明决定给 A 送一束花来表白。刚好小明打听到 A 和他有一个共同的朋友 B，于是内向的小明决定让 B 来代替自己完成送花这件事情

### 6.1代理的简单例子
```
//直接送给A
var Flower = function() {}
var xiaoming =  {
    sendFlower: function(target) {
        var flower = new Flower();
        target.revicerFlower(flower)
    }
}
var A = {
    revicerFlower: function(flower) {
        console.log('收到了花',+flower)
    }
}
xiaoming.sendFlower(A)

//先给B，B看A高兴了就送给A否则就不送
var Flower = function() {}
var xiaoming = {
    sendFlower: function(target) {
        var flower = new Flower();
        target.revicerFlower(flower)
    }
}
var B = {
    revicerFlower: function(flower) {
        //监听A的脾气
        A.listenGoodMood(function() {
            A.revicerFlower(flower)
        })
    }
}

var A = {
    revicerFlower: function(flower) {
        console.log('收到花' + flower)
    },
    listenGoodMood: function(fn) {
        setTimeout(function() {
            fn()
        }, 2000)
    }
}
xiaoming.sendFlower(B)
```

### 6.2 保护代理和虚拟代理
> new Flower 也是一个代价昂贵的操作，
那么我们可以把 new Flower 的操作交给代理 B 去执行，代理 B 会选择在 A 心情好时再执行 new
Flower ，这是代理模式的另一种形式，叫作虚拟代理。虚拟代理把一些开销很大的对象，延迟到
真正需要它的时候才去创建。代码如下

```
var B = {
    receiveFlower: function( flower ){
        A.listenGoodMood(function(){ // 监听 A 的好心情
            var flower = new Flower(); // 延迟创建 flower 对象
            A.receiveFlower( flower );
        });
    }
};
```

### 6.3虚拟代理实现图片懒加载
```
var myImage = (function(){
    var imgNode = document.createElement('img');
    document.body.appendChild(imageNode)
    return {
        setSrc: function(src) {
            imgNode = src;
        }
    }
})()
```